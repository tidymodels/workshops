{
  "hash": "f763c4ce44cf1dec8e9b54c63d259ee8",
  "result": {
    "markdown": "---\ntitle: \"3 - What makes a model?\"\nsubtitle: \"Machine learning with tidymodels\"\nformat:\n  revealjs: \n    slide-number: true\n    footer: <https://workshops.tidymodels.org>\n    include-before-body: header.html\n    include-after-body: footer-annotations.html\n    theme: [default, tidymodels.scss]\n    width: 1280\n    height: 720\nknitr:\n  opts_chunk: \n    echo: true\n    collapse: true\n    comment: \"#>\"\n    fig.path: \"figures/\"\n---\n\n\n\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*How do you fit a linear model in R?*\n\n*How many different ways can you think of?*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"how-to-fit-linear-model\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n. . .\n\n-   `lm` for linear model\n\n-   `glm` for generalized linear model (e.g. logistic regression)\n\n-   `glmnet` for regularized regression\n\n-   `keras` for regression using TensorFlow\n\n-   `stan` for Bayesian regression\n\n-   `spark` for large data sets\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n. . .\n\n::: columns\n::: {.column width=\"40%\"}\n-   Choose a [model]{.underline}\n-   Specify an engine\n-   Set the mode\n:::\n\n::: {.column width=\"60%\"}\n![](images/taxi_spinning.svg)\n:::\n:::\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic_reg()\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glm\n```\n:::\n\n\n\n:::notes\nModels have default engines\n:::\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n::: columns\n::: {.column width=\"40%\"}\n-   Choose a model\n-   Specify an [engine]{.underline}\n-   Set the mode\n:::\n\n::: {.column width=\"60%\"}\n![](images/taxi_spinning.svg)\n:::\n:::\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic_reg() %>%\n  set_engine(\"glmnet\")\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: glmnet\n```\n:::\n\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic_reg() %>%\n  set_engine(\"stan\")\n#> Logistic Regression Model Specification (classification)\n#> \n#> Computational engine: stan\n```\n:::\n\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n::: columns\n::: {.column width=\"40%\"}\n-   Choose a model\n-   Specify an engine\n-   Set the [mode]{.underline}\n:::\n\n::: {.column width=\"60%\"}\n![](images/taxi_spinning.svg)\n:::\n:::\n\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecision_tree()\n#> Decision Tree Model Specification (unknown mode)\n#> \n#> Computational engine: rpart\n```\n:::\n\n\n:::notes\nSome models have a default mode\n:::\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecision_tree() %>% \n  set_mode(\"classification\")\n#> Decision Tree Model Specification (classification)\n#> \n#> Computational engine: rpart\n```\n:::\n\n\n. . .\n\n<br></br>\n\n::: r-fit-text\nAll available models are listed at <https://www.tidymodels.org/find/parsnip/> \n:::\n\n##  {background-iframe=\"https://www.tidymodels.org/find/parsnip/\"}\n\n::: footer\n:::\n\n## To specify a model ![](hexes/parsnip.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n::: columns\n::: {.column width=\"40%\"}\n-   Choose a [model]{.underline}\n-   Specify an [engine]{.underline}\n-   Set the [mode]{.underline}\n:::\n\n::: {.column width=\"60%\"}\n![](images/taxi_spinning.svg)\n:::\n:::\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Run the `tree_spec` chunk in your `.qmd`.*\n\n*Edit this code to use a different model.*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"explore-tree-spec\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n<br></br>\n\n::: r-fit-text\nAll available models are listed at <https://www.tidymodels.org/find/parsnip/>\n:::\n\n## Models we'll be using today\n\n* Logistic regression\n* Decision trees\n\n## Logistic regression\n\n::: columns\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-10-1.svg){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"40%\"}\n:::\n:::\n\n## Logistic regression\n\n::: columns\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-11-1.svg){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"40%\"}\n:::\n:::\n\n## Logistic regression\n\n::: columns\n::: {.column width=\"60%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-12-1.svg){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"40%\"}\n\n-   Logit of outcome probability modeled as linear combination of predictors:\n\n$log(\\frac{p}{1 - p}) = \\beta_0 + \\beta_1\\cdot \\text{distance}$\n\n-   Find a sigmoid line that separates the two classes\n\n:::\n:::\n\n## Decision trees\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-14-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n:::\n:::\n\n## Decision trees\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-15-1.svg){fig-align='center' width=960}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n-   Series of splits or if/then statements based on predictors\n\n-   First the tree *grows* until some condition is met (maximum depth, no more data)\n\n-   Then the tree is *pruned* to reduce its complexity\n:::\n:::\n\n## Decision trees\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-16-1.svg){fig-align='center' width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-17-1.svg){width=768}\n:::\n:::\n\n:::\n:::\n\n## All models are wrong, but some are useful!\n\n::: columns\n::: {.column width=\"50%\"}\n### Logistic regression\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-18-1.svg){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n### Decision trees\n\n::: {.cell}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-19-1.svg){width=768}\n:::\n:::\n\n:::\n:::\n\n# A model workflow\n\n## Workflows bind preprocessors and models\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/good_workflow.png){fig-align='center' width=70%}\n:::\n:::\n\n\n:::notes\nExplain that PCA that is a preprocessor / dimensionality reduction, used to decorrelate data\n:::\n\n\n## What is wrong with this? {.annotation}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/bad_workflow.png){fig-align='center' width=70%}\n:::\n:::\n\n\n## Why a `workflow()`? ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n. . .\n\n-   Workflows handle new data better than base R tools in terms of new factor levels\n\n. . .\n\n-   You can use other preprocessors besides formulas (more on feature engineering tomorrow!)\n\n. . .\n\n-   They can help organize your work when working with multiple models\n\n. . .\n\n-   [Most importantly]{.underline}, a workflow captures the entire modeling process: `fit()` and `predict()` apply to the preprocessing steps in addition to the actual model fit\n\n::: notes\nTwo ways workflows handle levels better than base R:\n\n-   Enforces that new levels are not allowed at prediction time (this is an optional check that can be turned off)\n\n-   Restores missing levels that were present at fit time, but happen to be missing at prediction time (like, if your \"new\" data just doesn't have an instance of that level)\n:::\n\n## A model workflow ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_spec <-\n  decision_tree() %>% \n  set_mode(\"classification\")\n\ntree_spec %>% \n  fit(tip ~ ., data = taxi_train) \n#> parsnip model object\n#> \n#> n= 7045 \n#> \n#> node), split, n, loss, yval, (yprob)\n#>       * denotes terminal node\n#> \n#>  1) root 7045 2069 yes (0.70631654 0.29368346)  \n#>    2) company=Chicago Independents,City Service,Sun Taxi,Taxicab Insurance Agency Llc,other 4328  744 yes (0.82809612 0.17190388)  \n#>      4) distance< 4.615 2365  254 yes (0.89260042 0.10739958) *\n#>      5) distance>=4.615 1963  490 yes (0.75038207 0.24961793)  \n#>       10) distance>=12.565 1069   81 yes (0.92422825 0.07577175) *\n#>       11) distance< 12.565 894  409 yes (0.54250559 0.45749441)  \n#>         22) company=Chicago Independents,Sun Taxi,Taxicab Insurance Agency Llc 278   71 yes (0.74460432 0.25539568) *\n#>         23) company=City Service,other 616  278 no (0.45129870 0.54870130)  \n#>           46) distance< 7.205 178   59 yes (0.66853933 0.33146067) *\n#>           47) distance>=7.205 438  159 no (0.36301370 0.63698630) *\n#>    3) company=Flash Cab,Taxi Affiliation Services 2717 1325 yes (0.51232978 0.48767022)  \n#>      6) distance< 3.235 1331  391 yes (0.70623591 0.29376409) *\n#>      7) distance>=3.235 1386  452 no (0.32611833 0.67388167)  \n#>       14) distance>=12.39 344   90 yes (0.73837209 0.26162791) *\n#>       15) distance< 12.39 1042  198 no (0.19001919 0.80998081) *\n```\n:::\n\n\n## A model workflow ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_spec <-\n  decision_tree() %>% \n  set_mode(\"classification\")\n\nworkflow() %>%\n  add_formula(tip ~ .) %>%\n  add_model(tree_spec) %>%\n  fit(data = taxi_train) \n#> ══ Workflow [trained] ════════════════════════════════════════════════\n#> Preprocessor: Formula\n#> Model: decision_tree()\n#> \n#> ── Preprocessor ──────────────────────────────────────────────────────\n#> tip ~ .\n#> \n#> ── Model ─────────────────────────────────────────────────────────────\n#> n= 7045 \n#> \n#> node), split, n, loss, yval, (yprob)\n#>       * denotes terminal node\n#> \n#>  1) root 7045 2069 yes (0.70631654 0.29368346)  \n#>    2) company=Chicago Independents,City Service,Sun Taxi,Taxicab Insurance Agency Llc,other 4328  744 yes (0.82809612 0.17190388)  \n#>      4) distance< 4.615 2365  254 yes (0.89260042 0.10739958) *\n#>      5) distance>=4.615 1963  490 yes (0.75038207 0.24961793)  \n#>       10) distance>=12.565 1069   81 yes (0.92422825 0.07577175) *\n#>       11) distance< 12.565 894  409 yes (0.54250559 0.45749441)  \n#>         22) company=Chicago Independents,Sun Taxi,Taxicab Insurance Agency Llc 278   71 yes (0.74460432 0.25539568) *\n#>         23) company=City Service,other 616  278 no (0.45129870 0.54870130)  \n#>           46) distance< 7.205 178   59 yes (0.66853933 0.33146067) *\n#>           47) distance>=7.205 438  159 no (0.36301370 0.63698630) *\n#>    3) company=Flash Cab,Taxi Affiliation Services 2717 1325 yes (0.51232978 0.48767022)  \n#>      6) distance< 3.235 1331  391 yes (0.70623591 0.29376409) *\n#>      7) distance>=3.235 1386  452 no (0.32611833 0.67388167)  \n#>       14) distance>=12.39 344   90 yes (0.73837209 0.26162791) *\n#>       15) distance< 12.39 1042  198 no (0.19001919 0.80998081) *\n```\n:::\n\n\n## A model workflow ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_spec <-\n  decision_tree() %>% \n  set_mode(\"classification\")\n\nworkflow(tip ~ ., tree_spec) %>% \n  fit(data = taxi_train) \n#> ══ Workflow [trained] ════════════════════════════════════════════════\n#> Preprocessor: Formula\n#> Model: decision_tree()\n#> \n#> ── Preprocessor ──────────────────────────────────────────────────────\n#> tip ~ .\n#> \n#> ── Model ─────────────────────────────────────────────────────────────\n#> n= 7045 \n#> \n#> node), split, n, loss, yval, (yprob)\n#>       * denotes terminal node\n#> \n#>  1) root 7045 2069 yes (0.70631654 0.29368346)  \n#>    2) company=Chicago Independents,City Service,Sun Taxi,Taxicab Insurance Agency Llc,other 4328  744 yes (0.82809612 0.17190388)  \n#>      4) distance< 4.615 2365  254 yes (0.89260042 0.10739958) *\n#>      5) distance>=4.615 1963  490 yes (0.75038207 0.24961793)  \n#>       10) distance>=12.565 1069   81 yes (0.92422825 0.07577175) *\n#>       11) distance< 12.565 894  409 yes (0.54250559 0.45749441)  \n#>         22) company=Chicago Independents,Sun Taxi,Taxicab Insurance Agency Llc 278   71 yes (0.74460432 0.25539568) *\n#>         23) company=City Service,other 616  278 no (0.45129870 0.54870130)  \n#>           46) distance< 7.205 178   59 yes (0.66853933 0.33146067) *\n#>           47) distance>=7.205 438  159 no (0.36301370 0.63698630) *\n#>    3) company=Flash Cab,Taxi Affiliation Services 2717 1325 yes (0.51232978 0.48767022)  \n#>      6) distance< 3.235 1331  391 yes (0.70623591 0.29376409) *\n#>      7) distance>=3.235 1386  452 no (0.32611833 0.67388167)  \n#>       14) distance>=12.39 344   90 yes (0.73837209 0.26162791) *\n#>       15) distance< 12.39 1042  198 no (0.19001919 0.80998081) *\n```\n:::\n\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Run the `tree_wflow` chunk in your `.qmd`.*\n\n*Edit this code to make a workflow with your own model of choice.*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"explore-tree-workflow\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n## Predict with your model ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\nHow do you use your new `tree_fit` model?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_spec <-\n  decision_tree() %>% \n  set_mode(\"classification\")\n\ntree_fit <-\n  workflow(tip ~ ., tree_spec) %>% \n  fit(data = taxi_train) \n```\n:::\n\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Run:*\n\n`predict(tree_fit, new_data = taxi_test)`\n\n*What do you get?*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"predict-tree-fit\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n## Your turn\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Run:*\n\n`augment(tree_fit, new_data = taxi_test)`\n\n*What do you get?*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"augment-tree-fit\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n# The tidymodels prediction guarantee!\n\n. . .\n\n-   The predictions will always be inside a **tibble**\n-   The column names and types are **unsurprising** and **predictable**\n-   The number of rows in `new_data` and the output **are the same**\n\n## Understand your model ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\nHow do you **understand** your new `tree_fit` model?\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](figures/unnamed-chunk-27-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Understand your model ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\nHow do you **understand** your new `tree_fit` model?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rpart.plot)\ntree_fit %>%\n  extract_fit_engine() %>%\n  rpart.plot(roundint = FALSE)\n```\n:::\n\n\nYou can `extract_*()` several components of your fitted workflow.\n\n::: notes\n`roundint = FALSE` is only to quiet a warning\n:::\n\n\n## Understand your model ![](hexes/workflows.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"} ![](hexes/parsnip.png){.absolute top=-20 right=64 width=\"64\" height=\"74.24\"}\n\nHow do you **understand** your new `tree_fit` model?\n\n. . .\n\nYou can use your fitted workflow for model and/or prediction explanations:\n\n. . .\n\n-   overall variable importance, such as with the [vip](https://koalaverse.github.io/vip/) package\n\n. . .\n\n-   flexible model explainers, such as with the [DALEXtra](https://dalex.drwhy.ai/) package\n\n. . .\n\nLearn more at <https://www.tmwr.org/explain.html>\n\n##  {background-iframe=\"https://hardhat.tidymodels.org/reference/hardhat-extract.html\"}\n\n::: footer\n:::\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Extract the model engine object from your fitted workflow.*\n\n⚠️ *Never `predict()` with any extracted components!*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"extract-methods\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n:::notes\nAfterward, ask what kind of object people got from the extraction, and what they did with it (e.g. give it to `summary()`, `plot()`, `broom::tidy()` ). Live code along\n:::\n\n# Deploy your model ![](hexes/vetiver.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\n## {background-image=\"https://vetiver.rstudio.com/images/ml_ops_cycle.png\" background-size=\"contain\"}\n\n## Deploying a model ![](hexes/vetiver.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\nHow do you use your new `tree_fit` model in **production**?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vetiver)\nv <- vetiver_model(tree_fit, \"taxi\")\nv\n#> \n#> ── taxi ─ <bundled_workflow> model for deployment \n#> A rpart classification modeling workflow using 6 features\n```\n:::\n\n\nLearn more at <https://vetiver.rstudio.com>\n\n## Deploy your model ![](hexes/vetiver.png){.absolute top=-20 right=0 width=\"64\" height=\"74.24\"}\n\nHow do you use your new model `tree_fit` in **production**?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plumber)\npr() %>%\n  vetiver_api(v)\n#> # Plumber router with 2 endpoints, 4 filters, and 1 sub-router.\n#> # Use `pr_run()` on this object to start the API.\n#> ├──[queryString]\n#> ├──[body]\n#> ├──[cookieParser]\n#> ├──[sharedSecret]\n#> ├──/logo\n#> │  │ # Plumber static router serving from directory: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library/vetiver\n#> ├──/ping (GET)\n#> └──/predict (POST)\n```\n:::\n\n\nLearn more at <https://vetiver.rstudio.com>\n\n:::notes\nLive-code making a prediction\n:::\n\n## Your turn {transition=\"slide-in\"}\n\n![](images/parsnip-flagger.jpg){.absolute top=\"0\" right=\"0\" width=\"150\" height=\"150\"}\n\n*Run the `vetiver` chunk in your `.qmd`.*\n\n*Check out the automated visual documentation.*\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"vetiver\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n## The whole game - status update\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/whole-game-model-1.jpg){fig-align='center' width=1772}\n:::\n:::\n\n\n:::notes\nStress that fitting a model on the entire training set was only for illustrating how to fit a model\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"03-what-makes-a-model_files/libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"03-what-makes-a-model_files/libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}